color = "gray12",
size = 3,
check_overlap = TRUE
)
######ABSOLUTE POVERTY BY FAMILY TYPE - DIFFERENCIATED BY AREA (N-C-S) - Change 2021/2017####
layer1 <- pbhtasschart%>%filter(ITTER107!='IT')%>%filter(TIME ==2021)%>%mutate(catx=0)
layer2 <- pbhtasschart%>%filter(ITTER107!='IT')%>%filter(TIME ==2017)%>%mutate(catx=0)
######ABSOLUTE POVERTY BY FAMILY TYPE - DIFFERENCIATED BY AREA (N-C-S) - Change 2021/2017####
layer1 <- pbhtasschart%>%filter(ITTER107!='IT')%>%filter(TIME ==2021)
layer2 <- pbhtasschart%>%filter(ITTER107!='IT')%>%filter(TIME ==2017)
#imputation missing values ([C]p.sola 35-64 anni(2017)->2016; [C]p.sola 65+(2017)->2018; [C]monogenitore(2017)->2020)
layer2$Value[11]<-4.7
layer2$Value[12]<-4.0
layer2$Value[13]<-10.0
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,
position_nudge(y=0,x=2))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position_nudge(y=0,x=2))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.3),
color="#000000",show.legend = FALSE)+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.3,alpha=0.35),show.legend = FALSE) +
scale_y_continuous(
limits = c(-10, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
coord_polar()
crt
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,
position_nudge(y=0,x=1))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position_nudge(y=0,x=1))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.3),
color="#000000",show.legend = FALSE, position_nudge(y=0,x=1))+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.3,alpha=0.35),show.legend = FALSE, position_nudge(y=0,x=1)) +
scale_y_continuous(
limits = c(-10, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
coord_polar()
crt
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,position=position_dodge(0.5))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position=position_dodge(0.5))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.3),
color="#000000",show.legend = FALSE)+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.3,alpha=0.35),show.legend = FALSE) +
scale_y_continuous(
limits = c(-10, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
coord_polar()
crt
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,position=position_dodge(1))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position=position_dodge(1))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.3),
color="#000000",show.legend = FALSE)+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.3,alpha=0.35),show.legend = FALSE) +
scale_y_continuous(
limits = c(-10, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
coord_polar()
crt
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,position=position_dodge(5))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position=position_dodge(5))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.3),
color="#000000",show.legend = FALSE)+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.3,alpha=0.35),show.legend = FALSE) +
scale_y_continuous(
limits = c(-10, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
coord_polar()
crt
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,position=position_dodge(5))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position=position_dodge(5))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.3),
color="#000000",show.legend = FALSE)+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.3,alpha=0.35),show.legend = FALSE) +
scale_y_continuous(
limits = c(-10, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
scale_x_continuous(breaks = ninety,
limits = c(-10, 350))+
coord_polar()
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,position=position_dodge(5))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position=position_dodge(5))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.3),
color="#000000",show.legend = FALSE)+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.3,alpha=0.35),show.legend = FALSE) +
scale_y_continuous(
limits = c(-10, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
scale_x_continuous(breaks = c(0,40,80,120,160,200,240,280,320,360),
limits = c(-10, 350))+
coord_polar()
crt
scale_x_discrete()
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,position=position_dodge(5))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position=position_dodge(5))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.3),
color="#000000",show.legend = FALSE)+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.3,alpha=0.35),show.legend = FALSE) +
scale_y_continuous(
limits = c(-10, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
scale_x_discrete(breaks = c(0,40,80,120,160,200,240,280,320,360))+
coord_polar()
crt
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,position=position_dodge(5))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position=position_dodge(5))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.3),
color="#000000",show.legend = FALSE)+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.3,alpha=0.35),show.legend = FALSE) +
scale_y_continuous(
limits = c(-10, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
scale_x_discrete(breaks = waiver())+
coord_polar()
crt
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,position=position_dodge(5))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position=position_dodge(5))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.3),
color="#000000",show.legend = FALSE)+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.3,alpha=0.35),show.legend = FALSE) +
scale_y_continuous(
limits = c(-20, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
scale_x_discrete(breaks = waiver())+
coord_polar()
crt
crt+ annotate(
x = 0.25,
y = 5,
label = "   5   ",
geom = "text",
color = "gray12",
size = 3,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y = 10,
label = "   10   ",
geom = "text",
color = "gray12",
size = 3 ,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =15,
label = "   15   ",
geom = "text",
color = "gray12",
size = 3 ,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =20,
label = "   20   ",
geom = "text",
color = "gray12",
size = 3 ,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =25,
label = "   25   ",
geom = "text",
color = "gray12",
size = 3,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =30,
label = "   30   ",
geom = "text",
color = "gray12",
size = 3,
check_overlap = TRUE) +
annotate(
x = 0.25,
y =35,
label = "   35   ",
geom = "text",
color = "gray12",
size = 3 ,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =40,
label = "   40   ",
geom = "text",
color = "gray12",
size = 3,
check_overlap = TRUE
)
crt = ggplot()+
theme_minimal_grid(font_size = 8)+
geom_col(data= layer1,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value, fill=ITTER107),
show.legend = FALSE,position=position_dodge(5))+
facet_wrap(ITTER107~ .)+
geom_col(data= layer2,
aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value),
linetype="dashed",
size=0.75,
color="#375F53",
fill="transparent",
position=position_dodge(5))+
geom_point((data= avglayer1),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value),y=Value,size = 0.1),
color="#000000",show.legend = FALSE)+
geom_point((data= avglayer2),
mapping=aes(x= reorder(str_wrap(`Tipologia familiare`, 7), Value), y=Value,
size = 0.1,alpha=0.35),show.legend = FALSE) +
scale_y_continuous(
limits = c(-20, 45),
expand = c(0, 0),
breaks = c(0, 5,10,15,20,25,30,35,40,45))+
scale_x_discrete(breaks = waiver())+
coord_polar()
crt
crt+ annotate(
x = 0.25,
y = 5,
label = "   5 ",
geom = "text",
color = "gray12",
size = 2,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y = 10,
label = "   10 ",
geom = "text",
color = "gray12",
size = 2 ,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =15,
label = "   15 ",
geom = "text",
color = "gray12",
size = 2 ,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =20,
label = "   20 ",
geom = "text",
color = "gray12",
size = 2,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =25,
label = "   25 ",
geom = "text",
color = "gray12",
size = 2,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =30,
label = "   30 ",
geom = "text",
color = "gray12",
size = 2,
check_overlap = TRUE) +
annotate(
x = 0.25,
y =35,
label = "   35 ",
geom = "text",
color = "gray12",
size = 2 ,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =40,
label = "   40 ",
geom = "text",
color = "gray12",
size = 2,
check_overlap = TRUE
)
crt+ annotate(
x = 0.25,
y = 5,
label = "   5",
geom = "text",
color = "gray12",
size = 2,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y = 10,
label = "   10",
geom = "text",
color = "gray12",
size = 2 ,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =15,
label = "   15",
geom = "text",
color = "gray12",
size = 2 ,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =20,
label = "   20",
geom = "text",
color = "gray12",
size = 2,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =25,
label = "   25",
geom = "text",
color = "gray12",
size = 2,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =30,
label = "   30",
geom = "text",
color = "gray12",
size = 2,
check_overlap = TRUE) +
annotate(
x = 0.25,
y =35,
label = "   35",
geom = "text",
color = "gray12",
size = 2 ,
check_overlap = TRUE
) +
annotate(
x = 0.25,
y =40,
label = "   40",
geom = "text",
color = "gray12",
size = 2,
check_overlap = TRUE
)
